var c;try{c=global.vscode||require("vscode")}catch{c={window:{showInformationMessage:()=>({dispose:()=>{}}),showErrorMessage:()=>({dispose:()=>{}}),showWarningMessage:()=>({dispose:()=>{}}),activeTextEditor:null,messages:[]},commands:{registerCommand:()=>{}},ExtensionContext:function(){}}}function d(n,t="info",r=3e3){let e;switch(t){case"error":e=c.window.showErrorMessage(n);break;case"warning":e=c.window.showWarningMessage(n);break;default:e=c.window.showInformationMessage(n)}return c.window.messages&&c.window.messages.push({message:n,type:t,timeout:r}),r>0&&e&&typeof e.dispose=="function"&&setTimeout(()=>{try{e.dispose()}catch{}},r),e}function p(n){let t=String(n).replace(/\bTrue\b/g,"true").replace(/\bFalse\b/g,"false").replace(/\bNone\b/g,"null");t=t.replace(/([A-Za-z_]\w*)\s*\(/g,"{"),t=t.replace(/\)(\s*[,\]}])/g,"}$1"),t=t.replace(/([A-Za-z_]\w*)\s*=/g,'"$1": '),t=t.replace(/([{,]\s*)([A-Za-z_]\w*)(\s*:)/g,'$1"$2"$3'),t=t.replace(/'/g,'"');try{let r=JSON.parse(t);return JSON.stringify(r,null,4)}catch{try{let e=Function("return "+t)();return JSON.stringify(e,null,4)}catch{return t}}}function h(n){return n.replace(/\\"/g,'"').replace(/\\'/g,"'").replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	")}function y(n){let t=[],r="",e=!1,l=-1,s=0,o=!1,u=!1;for(let i=0;i<n.length;i++){let a=n[i];if(r+=a,u){u=!1;continue}if(a==="\\"){u=!0;continue}if(a==='"'||a==="'"){o=!o;continue}o||(a==="{"||a==="["?(s===0&&(l=i),s++,e=!0):(a==="}"||a==="]")&&(s--,s===0&&e&&(t.push({start:l,end:i+1,text:n.substring(l,i+1)}),e=!1))),(a===`
`||i===n.length-1)&&(r="")}if(t.length===0)return n;let f="",g=0;for(let i of t){f+=n.substring(g,i.start);try{let a=p(i.text),w=JSON.stringify(Function("return "+a)(),null,4);f+=w}catch{f+=i.text}g=i.end}return f+=n.substring(g),f}function m(n){return new Promise((t,r)=>{if(!n||!n.trim()){r(new Error("Invalid JSON: Empty input"));return}try{let e=h(n);try{let l=p(e),s=JSON.parse(l);t(JSON.stringify(s,null,4));return}catch{try{let s=p(e),o=Function("return "+s)();t(JSON.stringify(o,null,4));return}catch{let o=y(e);if(o===e&&(e.includes("{")||e.includes("["))){r(new Error("Invalid JSON: Please check your syntax"));return}t(o);return}}}catch(e){r(e)}})}function J(n){if(!c||!c.commands)return;let t=c.commands.registerCommand("extension.formatJson",async function(){let r=c.window.activeTextEditor;if(!r){d("No active editor found","warning");return}let e=r.document,l=r.selection;if(l.isEmpty){let s=new c.Range(e.positionAt(0),e.positionAt(e.getText().length)),o=e.getText(s);if(!o.trim()){d("Document is empty","warning");return}try{let u=await m(o);await r.edit(f=>{f.replace(s,u)}),d("Document JSON formatted successfully")}catch(u){d(u.message,"error")}}else{let s=e.getText(l);if(!s.trim()){d("Selected text is empty","warning");return}try{let o=await m(s);await r.edit(u=>{u.replace(l,o)}),d("Selected JSON formatted successfully")}catch(o){d(o.message,"error")}}});n&&n.subscriptions&&n.subscriptions.push(t)}function S(){}module.exports={activate:J,deactivate:S,formatJson:m};
